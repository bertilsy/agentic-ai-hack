cd challenge-3 && python agent-evaluator.py

üöÄ Starting Simple AI Agent Evaluation for Policy Checker
=======================================================
üîç Looking for agent named 'policy-checker'...
‚úÖ Found agent 'policy-checker' with ID: asst_ExpHoMZqVGGv5K2N2qkI9EPw
Class AIAgentConverter: This is an experimental class, and may change at any time. Please see https://aka.ms/azuremlexperimental for more information.
Class FDPAgentDataRetriever: This is an experimental class, and may change at any time. Please see https://aka.ms/azuremlexperimental for more information.
Class AIAgentDataRetriever: This is an experimental class, and may change at any time. Please see https://aka.ms/azuremlexperimental for more information.
üìù Running 5 test queries against the agent...
  Processing query 1/5: According to our motorcycle policy documents, what specific ...
  ‚úÖ Query 1 completed successfully
  Processing query 2/5: Based on our comprehensive auto policy, is vehicle theft cov...
  ‚úÖ Query 2 completed successfully
  Processing query 3/5: What are the specific liability coverage limits outlined in ...
  ‚úÖ Query 3 completed successfully
  Processing query 4/5: According to our high value vehicle policy documentation, wh...
  ‚úÖ Query 4 completed successfully
  Processing query 5/5: What specific exclusions and limitations are listed in our l...
  ‚úÖ Query 5 completed successfully
‚úÖ All test queries completed successfully!
üîß Setting up comprehensive evaluators...
Class ToolCallAccuracyEvaluator: This is an experimental class, and may change at any time. Please see https://aka.ms/azuremlexperimental for more information.
  ‚úÖ tool_call_accuracy evaluator added
Class IntentResolutionEvaluator: This is an experimental class, and may change at any time. Please see https://aka.ms/azuremlexperimental for more information.
  ‚úÖ intent_resolution evaluator added
Class TaskAdherenceEvaluator: This is an experimental class, and may change at any time. Please see https://aka.ms/azuremlexperimental for more information.
  ‚úÖ task_adherence evaluator added
Class CodeVulnerabilityEvaluator: This is an experimental class, and may change at any time. Please see https://aka.ms/azuremlexperimental for more information.
  ‚ö†Ô∏è  code_vulnerability evaluator skipped: (UserError) The 'azure_ai_project' dictionary is missing the following required field(s): resource_group_name, project_name, subscription_id.
Class ContentSafetyEvaluator: This is an experimental class, and may change at any time. Please see https://aka.ms/azuremlexperimental for more information.
Class ViolenceEvaluator: This is an experimental class, and may change at any time. Please see https://aka.ms/azuremlexperimental for more information.
  ‚ö†Ô∏è  content_safety evaluator skipped: (UserError) The 'azure_ai_project' dictionary is missing the following required field(s): resource_group_name, project_name, subscription_id.
Class IndirectAttackEvaluator: This is an experimental class, and may change at any time. Please see https://aka.ms/azuremlexperimental for more information.
  ‚ö†Ô∏è  indirect_attack evaluator skipped: (UserError) The 'azure_ai_project' dictionary is missing the following required field(s): resource_group_name, project_name, subscription_id.

üìä Running local evaluation with 4 evaluators...
[2025-09-19 09:38:41 +0000][promptflow._core.entry_meta_generator][WARNING] - Generate meta in current process and timeout won't take effect. Please handle timeout manually outside current process.
[2025-09-19 09:38:41 +0000][promptflow._core.entry_meta_generator][WARNING] - Generate meta in current process and timeout won't take effect. Please handle timeout manually outside current process.
[2025-09-19 09:38:41 +0000][promptflow._core.entry_meta_generator][WARNING] - Generate meta in current process and timeout won't take effect. Please handle timeout manually outside current process.
[2025-09-19 09:38:41 +0000][promptflow._core.entry_meta_generator][WARNING] - Generate meta in current process and timeout won't take effect. Please handle timeout manually outside current process.
[2025-09-19 09:38:41 +0000][promptflow._sdk._orchestrator.run_submitter][INFO] - Submitting run azure_ai_evaluation_evaluators_operational_metrics_20250919_093841_028178, log path: /home/vscode/.promptflow/.runs/azure_ai_evaluation_evaluators_operational_metrics_20250919_093841_028178/logs.txt
[2025-09-19 09:38:41 +0000][promptflow._sdk._orchestrator.run_submitter][INFO] - Submitting run azure_ai_evaluation_evaluators_tool_call_accuracy_20250919_093841_028572, log path: /home/vscode/.promptflow/.runs/azure_ai_evaluation_evaluators_tool_call_accuracy_20250919_093841_028572/logs.txt
[2025-09-19 09:38:41 +0000][promptflow._sdk._orchestrator.run_submitter][INFO] - Submitting run azure_ai_evaluation_evaluators_intent_resolution_20250919_093841_029216, log path: /home/vscode/.promptflow/.runs/azure_ai_evaluation_evaluators_intent_resolution_20250919_093841_029216/logs.txt
[2025-09-19 09:38:41 +0000][promptflow._sdk._orchestrator.run_submitter][INFO] - Submitting run azure_ai_evaluation_evaluators_task_adherence_20250919_093841_029625, log path: /home/vscode/.promptflow/.runs/azure_ai_evaluation_evaluators_task_adherence_20250919_093841_029625/logs.txt
2025-09-19 09:38:41 +0000   19382 execution.bulk     INFO     Current thread is not main thread, skip signal handler registration in BatchEngine.
2025-09-19 09:38:41 +0000   19382 execution.bulk     INFO     Finished 5 / 5 lines.
2025-09-19 09:38:41 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 0.01 seconds. Estimated time for incomplete lines: 0.0 seconds.
======= Run Summary =======

Run name: "azure_ai_evaluation_evaluators_tool_call_accuracy_20250919_093841_028572"
Run status: "Completed"
Start time: "2025-09-19 09:38:41.040608+00:00"
Duration: "0:00:01.492528"
Output path: "/home/vscode/.promptflow/.runs/azure_ai_evaluation_evaluators_tool_call_accuracy_20250919_093841_028572"

2025-09-19 09:38:48 +0000   19382 execution.bulk     INFO     Finished 1 / 5 lines.
2025-09-19 09:38:48 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 7.14 seconds. Estimated time for incomplete lines: 28.56 seconds.
2025-09-19 09:38:48 +0000   19382 execution.bulk     INFO     Finished 2 / 5 lines.
2025-09-19 09:38:48 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 3.57 seconds. Estimated time for incomplete lines: 10.71 seconds.
2025-09-19 09:38:48 +0000   19382 execution.bulk     INFO     Finished 3 / 5 lines.
2025-09-19 09:38:48 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 2.41 seconds. Estimated time for incomplete lines: 4.82 seconds.
2025-09-19 09:38:48 +0000   19382 execution.bulk     INFO     Finished 4 / 5 lines.
2025-09-19 09:38:48 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 1.83 seconds. Estimated time for incomplete lines: 1.83 seconds.
2025-09-19 09:38:49 +0000   19382 execution.bulk     INFO     Finished 5 / 5 lines.
2025-09-19 09:38:49 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 1.52 seconds. Estimated time for incomplete lines: 0.0 seconds.
2025-09-19 09:38:41 +0000   19382 execution.bulk     INFO     Current thread is not main thread, skip signal handler registration in BatchEngine.
2025-09-19 09:38:48 +0000   19382 execution.bulk     INFO     Finished 1 / 5 lines.
2025-09-19 09:38:48 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 7.14 seconds. Estimated time for incomplete lines: 28.56 seconds.
2025-09-19 09:38:48 +0000   19382 execution.bulk     INFO     Finished 2 / 5 lines.
2025-09-19 09:38:48 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 3.57 seconds. Estimated time for incomplete lines: 10.71 seconds.
2025-09-19 09:38:48 +0000   19382 execution.bulk     INFO     Finished 3 / 5 lines.
2025-09-19 09:38:48 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 2.41 seconds. Estimated time for incomplete lines: 4.82 seconds.
2025-09-19 09:38:48 +0000   19382 execution.bulk     INFO     Finished 4 / 5 lines.
2025-09-19 09:38:48 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 1.83 seconds. Estimated time for incomplete lines: 1.83 seconds.
2025-09-19 09:38:49 +0000   19382 execution.bulk     INFO     Finished 5 / 5 lines.
2025-09-19 09:38:49 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 1.52 seconds. Estimated time for incomplete lines: 0.0 seconds.
======= Run Summary =======

Run name: "azure_ai_evaluation_evaluators_intent_resolution_20250919_093841_029216"
Run status: "Completed"
Start time: "2025-09-19 09:38:41.039043+00:00"
Duration: "0:00:08.418389"
Output path: "/home/vscode/.promptflow/.runs/azure_ai_evaluation_evaluators_intent_resolution_20250919_093841_029216"

2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Finished 1 / 5 lines.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 8.53 seconds. Estimated time for incomplete lines: 34.12 seconds.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Finished 2 / 5 lines.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 4.41 seconds. Estimated time for incomplete lines: 13.23 seconds.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Process name(ForkProcess-2:2)-Process id(20121)-Line number(0) start execution.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Process name(ForkProcess-2:2)-Process id(20121)-Line number(0) completed.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Process name(ForkProcess-2:2)-Process id(20121)-Line number(1) start execution.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Process name(ForkProcess-2:2)-Process id(20121)-Line number(1) completed.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Process name(ForkProcess-2:2)-Process id(20121)-Line number(2) start execution.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Process name(ForkProcess-2:1)-Process id(20107)-Line number(4) start execution.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Process name(ForkProcess-2:3)-Process id(20133)-Line number(3) start execution.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Process name(ForkProcess-2:2)-Process id(20121)-Line number(2) completed.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Process name(ForkProcess-2:3)-Process id(20133)-Line number(3) completed.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Process name(ForkProcess-2:1)-Process id(20107)-Line number(4) completed.
2025-09-19 09:38:51 +0000   19382 execution.bulk     INFO     Finished 3 / 5 lines.
2025-09-19 09:38:51 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 3.18 seconds. Estimated time for incomplete lines: 6.36 seconds.
2025-09-19 09:38:51 +0000   19382 execution.bulk     INFO     Finished 4 / 5 lines.
2025-09-19 09:38:51 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 2.48 seconds. Estimated time for incomplete lines: 2.48 seconds.
2025-09-19 09:38:51 +0000   19382 execution.bulk     INFO     Finished 5 / 5 lines.
2025-09-19 09:38:51 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 2.0 seconds. Estimated time for incomplete lines: 0.0 seconds.
2025-09-19 09:38:51 +0000   19382 execution.bulk     INFO     The thread monitoring the process [20142-ForkProcess-2:4] will be terminated.
2025-09-19 09:38:51 +0000   19382 execution.bulk     INFO     The thread monitoring the process [20121-ForkProcess-2:2] will be terminated.
2025-09-19 09:38:51 +0000   19382 execution.bulk     INFO     The thread monitoring the process [20133-ForkProcess-2:3] will be terminated.
2025-09-19 09:38:51 +0000   19382 execution.bulk     INFO     The thread monitoring the process [20107-ForkProcess-2:1] will be terminated.
2025-09-19 09:38:51 +0000   19874 execution.bulk     INFO     Process 20121 terminated.
2025-09-19 09:38:51 +0000   19874 execution.bulk     WARNING  Process 20142 had been terminated.
2025-09-19 09:38:51 +0000   19874 execution.bulk     WARNING  Process 20133 had been terminated.
2025-09-19 09:38:51 +0000   19874 execution.bulk     WARNING  Process 20107 had been terminated.
2025-09-19 09:38:52 +0000   19382 execution.bulk     INFO     Finished 5 / 5 lines.
2025-09-19 09:38:52 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 2.11 seconds. Estimated time for incomplete lines: 0.0 seconds.
2025-09-19 09:38:41 +0000   19382 execution.bulk     INFO     Current thread is not main thread, skip signal handler registration in BatchEngine.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Finished 1 / 5 lines.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 8.53 seconds. Estimated time for incomplete lines: 34.12 seconds.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Finished 2 / 5 lines.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 4.41 seconds. Estimated time for incomplete lines: 13.23 seconds.
2025-09-19 09:38:51 +0000   19382 execution.bulk     INFO     Finished 3 / 5 lines.
2025-09-19 09:38:51 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 3.18 seconds. Estimated time for incomplete lines: 6.36 seconds.
2025-09-19 09:38:51 +0000   19382 execution.bulk     INFO     Finished 4 / 5 lines.
2025-09-19 09:38:51 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 2.48 seconds. Estimated time for incomplete lines: 2.48 seconds.
2025-09-19 09:38:51 +0000   20142 execution.bulk     INFO     The process [20142] has received a terminate signal.
2025-09-19 09:38:51 +0000   20133 execution.bulk     INFO     The process [20133] has received a terminate signal.
2025-09-19 09:38:51 +0000   20121 execution.bulk     INFO     The process [20121] has received a terminate signal.
2025-09-19 09:38:51 +0000   20107 execution.bulk     INFO     The process [20107] has received a terminate signal.
2025-09-19 09:38:52 +0000   19382 execution.bulk     INFO     Finished 5 / 5 lines.
2025-09-19 09:38:52 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 2.11 seconds. Estimated time for incomplete lines: 0.0 seconds.
======= Run Summary =======

Run name: "azure_ai_evaluation_evaluators_task_adherence_20250919_093841_029625"
Run status: "Completed"
Start time: "2025-09-19 09:38:41.043948+00:00"
Duration: "0:00:11.177209"
Output path: "/home/vscode/.promptflow/.runs/azure_ai_evaluation_evaluators_task_adherence_20250919_093841_029625"

2025-09-19 09:38:41 +0000   19382 execution.bulk     INFO     Current thread is not main thread, skip signal handler registration in BatchEngine.
2025-09-19 09:38:41 +0000   19382 execution.bulk     INFO     The timeout for the batch run is 3600 seconds.
2025-09-19 09:38:41 +0000   19382 execution.bulk     INFO     Set process count to 4 by taking the minimum value among the factors of {'default_worker_count': 4, 'row_count': 5}.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Process name(ForkProcess-2:2)-Process id(20121)-Line number(0) start execution.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Process name(ForkProcess-2:2)-Process id(20121)-Line number(0) completed.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Process name(ForkProcess-2:2)-Process id(20121)-Line number(1) start execution.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Process name(ForkProcess-2:2)-Process id(20121)-Line number(1) completed.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Process name(ForkProcess-2:2)-Process id(20121)-Line number(2) start execution.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Process name(ForkProcess-2:1)-Process id(20107)-Line number(4) start execution.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Process name(ForkProcess-2:3)-Process id(20133)-Line number(3) start execution.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Process name(ForkProcess-2:2)-Process id(20121)-Line number(2) completed.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Process name(ForkProcess-2:3)-Process id(20133)-Line number(3) completed.
2025-09-19 09:38:50 +0000   19382 execution.bulk     INFO     Process name(ForkProcess-2:1)-Process id(20107)-Line number(4) completed.
2025-09-19 09:38:51 +0000   19382 execution.bulk     INFO     Finished 5 / 5 lines.
2025-09-19 09:38:51 +0000   19382 execution.bulk     INFO     Average execution time for completed lines: 2.0 seconds. Estimated time for incomplete lines: 0.0 seconds.
2025-09-19 09:38:51 +0000   19382 execution.bulk     INFO     The thread monitoring the process [20142-ForkProcess-2:4] will be terminated.
2025-09-19 09:38:51 +0000   19382 execution.bulk     INFO     The thread monitoring the process [20121-ForkProcess-2:2] will be terminated.
2025-09-19 09:38:51 +0000   19382 execution.bulk     INFO     The thread monitoring the process [20133-ForkProcess-2:3] will be terminated.
2025-09-19 09:38:51 +0000   19382 execution.bulk     INFO     The thread monitoring the process [20107-ForkProcess-2:1] will be terminated.
======= Run Summary =======

Run name: "azure_ai_evaluation_evaluators_operational_metrics_20250919_093841_028178"
Run status: "Completed"
Start time: "2025-09-19 09:38:41.039196+00:00"
Duration: "0:00:11.638015"
Output path: "/home/vscode/.promptflow/.runs/azure_ai_evaluation_evaluators_operational_metrics_20250919_093841_028178"

======= Combined Run Summary (Per Evaluator) =======

{
    "operational_metrics": {
        "status": "Completed",
        "duration": "0:00:11.638015",
        "completed_lines": 5,
        "failed_lines": 0,
        "log_path": "/home/vscode/.promptflow/.runs/azure_ai_evaluation_evaluators_operational_metrics_20250919_093841_028178"
    },
    "tool_call_accuracy": {
        "status": "Completed",
        "duration": "0:00:01.492528",
        "completed_lines": 5,
        "failed_lines": 0,
        "log_path": "/home/vscode/.promptflow/.runs/azure_ai_evaluation_evaluators_tool_call_accuracy_20250919_093841_028572"
    },
    "intent_resolution": {
        "status": "Completed",
        "duration": "0:00:08.418389",
        "completed_lines": 5,
        "failed_lines": 0,
        "log_path": "/home/vscode/.promptflow/.runs/azure_ai_evaluation_evaluators_intent_resolution_20250919_093841_029216"
    },
    "task_adherence": {
        "status": "Completed",
        "duration": "0:00:11.177209",
        "completed_lines": 5,
        "failed_lines": 0,
        "log_path": "/home/vscode/.promptflow/.runs/azure_ai_evaluation_evaluators_task_adherence_20250919_093841_029625"
    }
}

====================================================

Evaluation results saved to "/workspaces/agentic-ai-hack/challenge-3/eval-output-simple.json".

‚úÖ Comprehensive evaluation completed!
operational_metrics.server-run-duration-in-seconds | 4.40
operational_metrics.client-run-duration-in-seconds | 5.57
operational_metrics.completion-tokens | 205.00
operational_metrics.prompt-tokens   | 2009.20
tool_call_accuracy.tool_call_accuracy_threshold | 0.80
intent_resolution.intent_resolution | 4.80
intent_resolution.intent_resolution_threshold | 3.00
task_adherence.task_adherence       | 4.60
task_adherence.task_adherence_threshold | 3.00
tool_call_accuracy.binary_aggregate | 0.00
intent_resolution.binary_aggregate  | 1.00
task_adherence.binary_aggregate     | 1.00
======================================================================
Evaluation input: /workspaces/agentic-ai-hack/challenge-3/eval-input-simple.jsonl
Evaluation output: /workspaces/agentic-ai-hack/challenge-3/eval-output-simple.json
======================================================================
Could not write .xlsx (fallback to CSV): No module named 'openpyxl'
Saved CSV metrics table to: /workspaces/agentic-ai-hack/challenge-3/eval-metrics-table.csv